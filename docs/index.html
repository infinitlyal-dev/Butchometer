<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>BUTCHOMETER</title>
  
  <!-- Social Meta Tags -->
  <meta property="og:title" content="BUTCHOMETER">
  <meta property="og:description" content="Ten questions. No mercy. How butch are you?">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://infinitlyal-dev.github.io/Butchometer/">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="BUTCHOMETER">
  <meta name="twitter:description" content="Ten questions. No mercy.">
  <meta name="theme-color" content="#d4621a">
  
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --orange: #d4621a;
      --orange-glow: #ff6b1a;
      --orange-hot: #ff8534;
      --orange-dim: #7a3a10;
      --ember: #ff4500;
      --lava-bright: #ff5500;
      --lava-mid: #cc3300;
      --lava-dark: #661a00;
      --black: #080706;
      --steel-darkest: #0c0b0a;
      --steel-dark: #131211;
      --steel-mid: #1a1918;
      --steel-light: #242220;
      --steel-lighter: #322f2c;
      --steel-edge: #433f3a;
      --steel-highlight: #5a5550;
      --text-primary: #c8c4bc;
      --text-dim: #6a665f;
      --text-muted: #3a3835;
    }

    * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0; padding: 0; }
    html, body { height: 100%; overflow-x: hidden; }
    
    body { 
      font-family: 'IBM Plex Mono', monospace;
      background: var(--black);
      min-height: 100vh;
      color: var(--text-primary);
      line-height: 1.65;
    }

    /* ========== SCREEN SHAKE ========== */
    .shake-small {
      animation: shakeSmall 0.15s ease-out;
    }
    .shake-medium {
      animation: shakeMedium 0.2s ease-out;
    }
    .shake-tiny {
      animation: shakeTiny 0.1s ease-out;
    }
    
    @keyframes shakeSmall {
      0%, 100% { transform: translate(0, 0); }
      25% { transform: translate(-4px, 2px); }
      50% { transform: translate(3px, -3px); }
      75% { transform: translate(-2px, 1px); }
    }
    @keyframes shakeMedium {
      0%, 100% { transform: translate(0, 0); }
      20% { transform: translate(-6px, 3px); }
      40% { transform: translate(5px, -5px); }
      60% { transform: translate(-4px, 2px); }
      80% { transform: translate(3px, -2px); }
    }
    @keyframes shakeTiny {
      0%, 100% { transform: translate(0, 0); }
      50% { transform: translate(-2px, 1px); }
    }

    /* ========== TEXTURE & ATMOSPHERE ========== */
    .texture {
      position: fixed;
      inset: 0;
      background: 
        repeating-linear-gradient(
          -45deg,
          transparent 0px,
          transparent 1px,
          rgba(255,255,255,0.015) 1px,
          rgba(255,255,255,0.015) 2px
        ),
        radial-gradient(ellipse at 50% 120%, rgba(212,98,26,0.1) 0%, transparent 60%);
      pointer-events: none;
      z-index: 0;
    }

    .furnace-glow {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      height: 350px;
      background: radial-gradient(ellipse at 50% 100%, rgba(212,98,26,0.15) 0%, rgba(255,69,0,0.06) 30%, transparent 70%);
      pointer-events: none;
      z-index: 0;
      animation: furnacePulse 3s ease-in-out infinite;
    }

    @keyframes furnacePulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.6; }
    }

    /* ========== EMBER PARTICLES ========== */
    .ember-container {
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 1;
      overflow: hidden;
    }

    .ember {
      position: absolute;
      width: 3px;
      height: 3px;
      background: var(--ember);
      border-radius: 50%;
      opacity: 0;
      box-shadow: 0 0 6px 2px rgba(255,69,0,0.7), 0 0 12px 4px rgba(255,107,26,0.4);
      animation: emberFloat 7s ease-out infinite;
    }

    @keyframes emberFloat {
      0% { opacity: 0; transform: translateY(100vh) scale(0.5); }
      10% { opacity: 1; }
      90% { opacity: 0.6; }
      100% { opacity: 0; transform: translateY(-20vh) translateX(var(--drift, 30px)) scale(0.2); }
    }

    /* ========== FORGED STEEL TITLE - BOLDER ========== */
    .forged-title {
      font-family: 'IBM Plex Mono', monospace;
      font-weight: 700;
      letter-spacing: 0.12em;
      text-transform: uppercase;
      font-size: clamp(3rem, 12vw, 5rem);
      position: relative;
      display: inline-block;
      line-height: 1;
      
      /* Hammered/embossed steel effect */
      background: linear-gradient(
        180deg,
        var(--steel-edge) 0%,
        var(--steel-highlight) 20%,
        var(--steel-lighter) 40%,
        var(--steel-edge) 60%,
        var(--steel-mid) 80%,
        var(--steel-dark) 100%
      );
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      
      /* Deep emboss shadows */
      text-shadow: 
        0 2px 0 rgba(0,0,0,0.8),
        0 -1px 0 rgba(255,255,255,0.1),
        0 4px 8px rgba(0,0,0,0.9),
        0 8px 16px rgba(0,0,0,0.6);
      
      filter: drop-shadow(0 6px 12px rgba(0,0,0,0.9));
    }

    /* Internal glow - heated metal effect */
    .forged-title::before {
      content: 'BUTCHOMETER';
      position: absolute;
      left: 0;
      top: 0;
      background: linear-gradient(
        180deg,
        transparent 0%,
        rgba(255,80,0,0.5) 25%,
        rgba(255,120,20,0.7) 50%,
        rgba(255,80,0,0.5) 75%,
        transparent 100%
      );
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      animation: internalGlow 2s ease-in-out infinite;
      filter: blur(1px);
    }

    /* Aggressive pulsing underline bar */
    .forged-title::after {
      content: '';
      position: absolute;
      left: -5%;
      right: -5%;
      bottom: -12px;
      height: 6px;
      background: linear-gradient(90deg, 
        transparent 0%, 
        var(--lava-dark) 10%,
        var(--orange) 30%, 
        var(--orange-hot) 50%, 
        var(--orange) 70%,
        var(--lava-dark) 90%,
        transparent 100%
      );
      border-radius: 3px;
      box-shadow: 
        0 0 20px var(--orange), 
        0 0 40px rgba(255,69,0,0.6),
        0 0 60px rgba(255,69,0,0.3),
        0 2px 4px rgba(0,0,0,0.8);
      animation: emberBarAggressive 1.5s ease-in-out infinite;
    }

    @keyframes internalGlow {
      0%, 100% { opacity: 0.5; }
      50% { opacity: 0.9; }
    }

    @keyframes emberBarAggressive {
      0%, 100% { 
        opacity: 0.7; 
        transform: scaleX(0.92);
        box-shadow: 0 0 15px var(--orange), 0 0 30px rgba(255,69,0,0.4);
      }
      50% { 
        opacity: 1; 
        transform: scaleX(1.02);
        box-shadow: 0 0 30px var(--orange-hot), 0 0 60px rgba(255,69,0,0.7), 0 0 80px rgba(255,69,0,0.4);
      }
    }

    /* Heat shimmer rising from title */
    .heat-shimmer {
      position: relative;
    }
    .heat-shimmer::before {
      content: '';
      position: absolute;
      left: -30px;
      right: -30px;
      top: -60px;
      bottom: -20px;
      background: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
      opacity: 0.04;
      pointer-events: none;
      animation: shimmerRise 0.12s steps(4) infinite;
      mask-image: linear-gradient(to top, rgba(0,0,0,0.3), transparent 70%);
      -webkit-mask-image: linear-gradient(to top, rgba(0,0,0,0.3), transparent 70%);
    }

    @keyframes shimmerRise {
      0% { transform: translateY(0); }
      25% { transform: translateY(-2px) translateX(1px); }
      50% { transform: translateY(-1px) translateX(-1px); }
      75% { transform: translateY(-3px); }
      100% { transform: translateY(0); }
    }

    /* Title ember particles */
    .title-embers {
      position: absolute;
      inset: -40px;
      pointer-events: none;
      overflow: visible;
    }
    .title-ember {
      position: absolute;
      width: 4px;
      height: 4px;
      background: var(--orange-hot);
      border-radius: 50%;
      box-shadow: 0 0 8px var(--orange), 0 0 16px rgba(255,69,0,0.5);
      animation: titleEmberFloat 3s ease-out infinite;
    }
    @keyframes titleEmberFloat {
      0% { opacity: 0; transform: translateY(20px) scale(0.5); }
      20% { opacity: 1; }
      100% { opacity: 0; transform: translateY(-80px) translateX(var(--drift)) scale(0.2); }
    }

    /* ========== LAVA POOL ========== */
    .lava-pool {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      height: 70px;
      z-index: 50;
      pointer-events: none;
      overflow: hidden;
    }
    
    .lava-pool-surface {
      position: absolute;
      bottom: 0;
      left: -10%;
      right: -10%;
      height: 100%;
      background: linear-gradient(to bottom,
        rgba(255,100,0,0.9) 0%,
        rgba(204,51,0,0.95) 30%,
        rgba(153,34,0,1) 60%,
        rgba(102,26,0,1) 100%
      );
      box-shadow: 
        0 -10px 40px rgba(255,69,0,0.4),
        0 -20px 60px rgba(255,50,0,0.2),
        inset 0 5px 20px rgba(255,150,50,0.3);
      animation: lavaSurfaceWave 4s ease-in-out infinite;
    }
    
    @keyframes lavaSurfaceWave {
      0%, 100% { transform: translateY(0) scaleY(1); }
      50% { transform: translateY(-3px) scaleY(1.05); }
    }
    
    .lava-pool-glow {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 150px;
      background: radial-gradient(ellipse at 50% 100%, rgba(255,69,0,0.3) 0%, transparent 70%);
      pointer-events: none;
    }
    
    /* Lava bubbles */
    .lava-bubble {
      position: absolute;
      bottom: 10px;
      width: 8px;
      height: 8px;
      background: radial-gradient(circle, rgba(255,200,100,0.9), rgba(255,100,0,0.7));
      border-radius: 50%;
      animation: lavaBubble 2s ease-in-out infinite;
      box-shadow: 0 0 10px rgba(255,150,50,0.6);
    }
    
    @keyframes lavaBubble {
      0% { transform: translateY(0) scale(0.3); opacity: 0; }
      30% { opacity: 0.8; }
      60% { transform: translateY(-25px) scale(1); opacity: 0.9; }
      100% { transform: translateY(-35px) scale(0.5); opacity: 0; }
    }

    /* Lava eruption particles */
    .lava-particle {
      position: fixed;
      border-radius: 50%;
      pointer-events: none;
      z-index: 100;
    }

    /* Pool flash on eruption */
    .lava-pool-flash {
      animation: poolFlash 0.3s ease-out;
    }
    @keyframes poolFlash {
      0% { filter: brightness(2); }
      100% { filter: brightness(1); }
    }

    /* ========== SPARK PARTICLES ========== */
    .spark {
      position: absolute;
      width: 4px;
      height: 4px;
      background: var(--orange-hot);
      border-radius: 50%;
      pointer-events: none;
      box-shadow: 0 0 6px var(--orange), 0 0 12px rgba(255,150,50,0.5);
    }

    /* ========== BUTTONS ========== */
    .btn {
      position: relative;
      background: linear-gradient(180deg, var(--steel-light) 0%, var(--steel-mid) 40%, var(--steel-dark) 100%);
      border: 1px solid var(--steel-lighter);
      border-bottom: 3px solid var(--black);
      box-shadow: 
        0 4px 16px rgba(0,0,0,0.7),
        inset 0 1px 0 rgba(255,255,255,0.06),
        inset 0 -2px 4px rgba(0,0,0,0.2);
      transition: all 0.1s ease;
      cursor: pointer;
      overflow: hidden;
    }

    .btn::before {
      content: '';
      position: absolute;
      inset: 0;
      background: linear-gradient(180deg, rgba(255,255,255,0.05) 0%, transparent 50%);
      pointer-events: none;
    }

    .btn:hover {
      background: linear-gradient(180deg, var(--steel-lighter) 0%, var(--steel-light) 40%, var(--steel-mid) 100%);
      box-shadow: 
        0 4px 20px rgba(0,0,0,0.8),
        0 0 20px rgba(212,98,26,0.15),
        inset 0 1px 0 rgba(255,255,255,0.08);
    }

    .btn:active {
      transform: translateY(3px);
      border-bottom-width: 1px;
      box-shadow: 
        0 1px 4px rgba(0,0,0,0.6),
        inset 0 2px 6px rgba(0,0,0,0.4);
    }

    .btn:focus-visible {
      outline: 2px solid var(--orange);
      outline-offset: 3px;
    }

    .btn-primary {
      border-color: var(--orange-dim);
      box-shadow: 
        0 4px 16px rgba(0,0,0,0.7),
        0 0 0 1px rgba(212,98,26,0.4),
        0 0 30px rgba(212,98,26,0.15),
        inset 0 1px 0 rgba(255,255,255,0.06);
    }

    .btn-primary:hover {
      box-shadow: 
        0 4px 24px rgba(212,98,26,0.35),
        0 0 0 1px rgba(212,98,26,0.6),
        0 0 40px rgba(212,98,26,0.25),
        inset 0 1px 0 rgba(255,255,255,0.08);
    }

    /* ========== CARDS & PANELS ========== */
    .card {
      position: relative;
      background: linear-gradient(180deg, var(--steel-mid) 0%, var(--steel-dark) 100%);
      border: 1px solid var(--steel-lighter);
      box-shadow: 
        0 8px 40px rgba(0,0,0,0.6),
        inset 0 1px 0 rgba(255,255,255,0.04),
        inset 0 -1px 0 rgba(0,0,0,0.3);
    }

    .card::before {
      content: '';
      position: absolute;
      inset: 0;
      background: repeating-linear-gradient(90deg, transparent 0px, transparent 2px, rgba(255,255,255,0.01) 2px, rgba(255,255,255,0.01) 4px);
      pointer-events: none;
      border-radius: inherit;
    }

    /* ========== INPUTS ========== */
    .input {
      background: var(--steel-darkest);
      border: 2px solid var(--steel-mid);
      border-top-color: var(--black);
      color: var(--text-primary);
      box-shadow: inset 0 3px 8px rgba(0,0,0,0.5);
      transition: all 0.2s ease;
    }

    .input:focus {
      outline: none;
      border-color: var(--orange-dim);
      box-shadow: 
        inset 0 3px 8px rgba(0,0,0,0.5),
        0 0 0 3px rgba(212,98,26,0.25),
        0 0 25px rgba(212,98,26,0.2);
    }

    .input::placeholder { color: var(--text-muted); }

    /* ========== ANSWER BUTTONS ========== */
    .answer {
      position: relative;
      background: linear-gradient(180deg, var(--steel-mid) 0%, var(--steel-dark) 100%);
      border: 1px solid var(--steel-lighter);
      border-left: 5px solid var(--steel-lighter);
      transition: all 0.15s ease;
      cursor: pointer;
      overflow: visible;
    }

    .answer::before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      bottom: 0;
      width: 0;
      background: linear-gradient(90deg, rgba(212,98,26,0.2), transparent);
      transition: width 0.2s ease;
    }

    .answer:hover {
      background: linear-gradient(180deg, var(--steel-light) 0%, var(--steel-mid) 100%);
      transform: translateX(4px);
      border-left-color: var(--orange-dim);
    }

    .answer:hover::before {
      width: 120px;
    }

    .answer:active {
      background: var(--steel-dark);
      transform: translateX(6px) scale(0.99);
    }

    .answer:focus-visible {
      outline: 2px solid var(--orange);
      outline-offset: 3px;
    }

    .answer-label {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 32px;
      height: 32px;
      background: var(--steel-darkest);
      border: 2px solid var(--steel-edge);
      border-radius: 6px;
      font-weight: 700;
      font-size: 0.8rem;
      color: var(--text-dim);
      flex-shrink: 0;
      margin-right: 14px;
      transition: all 0.15s ease;
    }

    .answer:hover .answer-label {
      background: var(--steel-mid);
      border-color: var(--orange);
      color: var(--orange);
      box-shadow: 0 0 10px rgba(212,98,26,0.3);
    }

    /* ========== PROGRESS BAR ========== */
    .progress-track {
      background: var(--steel-darkest);
      border: 1px solid var(--steel-mid);
      box-shadow: inset 0 2px 6px rgba(0,0,0,0.6);
      position: relative;
      overflow: hidden;
    }

    .progress-fill {
      background: linear-gradient(90deg, var(--orange-dim) 0%, var(--orange) 50%, var(--orange-hot) 100%);
      box-shadow: 0 0 15px rgba(212,98,26,0.6), 0 0 30px rgba(255,69,0,0.3);
      transition: width 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
    }

    .progress-fill::after {
      content: '';
      position: absolute;
      right: 0;
      top: 0;
      bottom: 0;
      width: 30px;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4));
      animation: progressShine 1.2s ease-in-out infinite;
    }

    @keyframes progressShine {
      0%, 100% { opacity: 0.4; }
      50% { opacity: 1; }
    }

    /* ========== GAUGE ========== */
    .gauge {
      background: 
        conic-gradient(
          from 180deg,
          var(--steel-lighter) 0deg,
          var(--steel-mid) 45deg,
          var(--steel-dark) 90deg,
          var(--steel-mid) 135deg,
          var(--steel-lighter) 180deg,
          var(--steel-mid) 225deg,
          var(--steel-dark) 270deg,
          var(--steel-mid) 315deg,
          var(--steel-lighter) 360deg
        );
      box-shadow: 
        0 0 0 8px var(--steel-dark),
        0 0 0 10px var(--steel-lighter),
        0 0 0 14px var(--black),
        0 0 80px rgba(212,98,26,0.25),
        inset 0 0 80px rgba(0,0,0,0.8);
    }

    .gauge-spin {
      animation: gaugeSpin 2.5s cubic-bezier(0.15, 0.85, 0.25, 1) forwards;
    }

    @keyframes gaugeSpin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(1080deg); }
    }

    .score-display {
      color: var(--orange);
      text-shadow: 
        0 0 40px rgba(212,98,26,0.7),
        0 0 80px rgba(255,69,0,0.4),
        0 2px 4px rgba(0,0,0,0.9);
    }

    .score-reveal {
      animation: scoreReveal 0.5s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
    }

    @keyframes scoreReveal {
      0% { transform: scale(0.3); opacity: 0; }
      60% { transform: scale(1.15); }
      100% { transform: scale(1); opacity: 1; }
    }

    /* ========== ANIMATIONS ========== */
    .fade-in { animation: fadeIn 0.35s ease-out forwards; }
    .slide-in { animation: slideIn 0.3s ease-out forwards; }
    .heavy-in { animation: heavyIn 0.5s cubic-bezier(0.2, 0, 0.3, 1) forwards; }

    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    @keyframes slideIn { from { opacity: 0; transform: translateY(16px); } to { opacity: 1; transform: translateY(0); } }
    @keyframes heavyIn { from { opacity: 0; transform: translateY(24px) scale(0.97); } to { opacity: 1; transform: translateY(0) scale(1); } }

    .screen-enter { animation: screenEnter 0.4s ease-out forwards; }
    @keyframes screenEnter { from { opacity: 0; } to { opacity: 1; } }

    /* ========== MUTE TOGGLE ========== */
    .mute-toggle {
      position: fixed;
      top: 16px;
      right: 16px;
      z-index: 200;
      width: 44px;
      height: 44px;
      background: var(--steel-dark);
      border: 1px solid var(--steel-lighter);
      border-radius: 10px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.15s ease;
      color: var(--text-dim);
    }

    .mute-toggle:hover {
      background: var(--steel-mid);
      color: var(--text-primary);
    }

    .mute-toggle.muted {
      color: var(--orange-dim);
    }

    .mute-toggle:focus-visible {
      outline: 2px solid var(--orange);
      outline-offset: 2px;
    }

    /* ========== TOAST ========== */
    .toast {
      position: fixed;
      bottom: 100px;
      left: 50%;
      transform: translateX(-50%) translateY(100px);
      background: var(--steel-mid);
      border: 1px solid var(--orange-dim);
      padding: 14px 28px;
      border-radius: 10px;
      color: var(--text-primary);
      font-size: 0.875rem;
      z-index: 1000;
      opacity: 0;
      transition: all 0.3s ease;
      box-shadow: 0 8px 32px rgba(0,0,0,0.7), 0 0 30px rgba(212,98,26,0.25);
    }

    .toast.show {
      transform: translateX(-50%) translateY(0);
      opacity: 1;
    }

    /* ========== SHARE BUTTON ========== */
    .share-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }

    .share-btn svg {
      width: 20px;
      height: 20px;
    }

    /* ========== PLAQUE ========== */
    .plaque {
      background: linear-gradient(180deg, var(--steel-light) 0%, var(--steel-mid) 50%, var(--steel-dark) 100%);
      border: 1px solid var(--steel-lighter);
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.05), 0 6px 20px rgba(0,0,0,0.5);
    }

    /* ========== QUESTION NUMBER ========== */
    .question-number {
      font-size: 0.75rem;
      font-weight: 600;
      letter-spacing: 0.15em;
      padding: 6px 14px;
      background: var(--steel-darkest);
      border: 1px solid var(--steel-edge);
      border-radius: 6px;
    }

    /* ========== REDUCED MOTION ========== */
    @media (prefers-reduced-motion: reduce) {
      *, *::before, *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
      }
      .ember, .furnace-glow, .heat-shimmer::before, .title-ember,
      .lava-bubble, .lava-particle, .spark, .shake-small, .shake-medium, .shake-tiny {
        display: none !important;
        animation: none !important;
      }
      .lava-pool-surface {
        animation: none !important;
      }
    }
  </style>
</head>
<body>
  <div class="texture"></div>
  <div class="furnace-glow"></div>
  <div class="ember-container" id="embers"></div>
  <button class="mute-toggle" id="muteToggle" onclick="toggleMute()" aria-label="Toggle sound">
    <svg id="soundIcon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <path d="M11 5L6 9H2v6h4l5 4V5z"/>
      <path id="soundWaves" d="M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07"/>
    </svg>
  </button>
  <div id="toast" class="toast"></div>
  <div id="app" class="relative z-10 min-h-screen"></div>
  <div id="lavaPool" class="lava-pool" style="display: none;">
    <div class="lava-pool-glow"></div>
    <div class="lava-pool-surface" id="lavaPoolSurface"></div>
  </div>

  <script>
    // ========== WEB AUDIO API SOUND SYSTEM ==========
    let audioCtx = null;
    let isMuted = localStorage.getItem('butchometer_muted') === 'true';

    function initAudio() {
      if (!audioCtx) {
        audioCtx = new (window.AudioContext || window.webkitAudioContext)();
      }
      if (audioCtx.state === 'suspended') {
        audioCtx.resume();
      }
    }

    function updateMuteIcon() {
      const waves = document.getElementById('soundWaves');
      const toggle = document.getElementById('muteToggle');
      if (isMuted) {
        waves.style.display = 'none';
        toggle.classList.add('muted');
      } else {
        waves.style.display = '';
        toggle.classList.remove('muted');
      }
    }

    function toggleMute() {
      isMuted = !isMuted;
      localStorage.setItem('butchometer_muted', isMuted);
      updateMuteIcon();
      if (!isMuted) {
        initAudio();
        playSound('click');
      }
    }

    // Synthesized SFX
    function playSound(type, intensity = 1) {
      if (isMuted || !audioCtx) return;
      
      try {
        const now = audioCtx.currentTime;
        
        switch(type) {
          case 'click':
          case 'thunk': {
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            const filter = audioCtx.createBiquadFilter();
            
            osc.type = 'sine';
            osc.frequency.setValueAtTime(90, now);
            osc.frequency.exponentialRampToValueAtTime(35, now + 0.12);
            
            filter.type = 'lowpass';
            filter.frequency.setValueAtTime(250, now);
            
            gain.gain.setValueAtTime(0.5, now);
            gain.gain.exponentialRampToValueAtTime(0.01, now + 0.18);
            
            osc.connect(filter);
            filter.connect(gain);
            gain.connect(audioCtx.destination);
            
            osc.start(now);
            osc.stop(now + 0.18);
            break;
          }
          
          case 'safe': {
            playEruption(0.4);
            break;
          }
          
          case 'mid': {
            playEruption(0.7);
            break;
          }
          
          case 'unhinged': {
            playEruption(1.0);
            break;
          }

          case 'eruption': {
            playEruption(intensity);
            break;
          }
          
          case 'whoosh': {
            const noise = createNoise(0.4);
            const filter = audioCtx.createBiquadFilter();
            const gain = audioCtx.createGain();
            
            filter.type = 'bandpass';
            filter.frequency.setValueAtTime(400, now);
            filter.frequency.exponentialRampToValueAtTime(2500, now + 0.15);
            filter.frequency.exponentialRampToValueAtTime(200, now + 0.45);
            filter.Q.setValueAtTime(3, now);
            
            gain.gain.setValueAtTime(0, now);
            gain.gain.linearRampToValueAtTime(0.25, now + 0.06);
            gain.gain.exponentialRampToValueAtTime(0.01, now + 0.45);
            
            noise.connect(filter);
            filter.connect(gain);
            gain.connect(audioCtx.destination);
            break;
          }

          case 'spinStart': {
            // Metallic grinding start
            const noise = createNoise(2.8);
            const filter = audioCtx.createBiquadFilter();
            const gain = audioCtx.createGain();
            
            filter.type = 'bandpass';
            filter.frequency.setValueAtTime(200, now);
            filter.frequency.linearRampToValueAtTime(800, now + 2.5);
            filter.Q.setValueAtTime(5, now);
            
            gain.gain.setValueAtTime(0, now);
            gain.gain.linearRampToValueAtTime(0.15, now + 0.3);
            gain.gain.setValueAtTime(0.15, now + 2.2);
            gain.gain.exponentialRampToValueAtTime(0.01, now + 2.6);
            
            noise.connect(filter);
            filter.connect(gain);
            gain.connect(audioCtx.destination);

            // Metallic clicks accelerating
            for (let i = 0; i < 20; i++) {
              const delay = 0.2 + (i * 0.12) - (i * i * 0.003);
              if (delay < 2.4) {
                setTimeout(() => {
                  if (!isMuted && audioCtx) {
                    const clickOsc = audioCtx.createOscillator();
                    const clickGain = audioCtx.createGain();
                    clickOsc.type = 'square';
                    clickOsc.frequency.setValueAtTime(800 + i * 50, audioCtx.currentTime);
                    clickGain.gain.setValueAtTime(0.08, audioCtx.currentTime);
                    clickGain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.03);
                    clickOsc.connect(clickGain);
                    clickGain.connect(audioCtx.destination);
                    clickOsc.start();
                    clickOsc.stop(audioCtx.currentTime + 0.03);
                  }
                }, delay * 1000);
              }
            }

            // Low rumble
            const rumbleOsc = audioCtx.createOscillator();
            const rumbleGain = audioCtx.createGain();
            rumbleOsc.type = 'sine';
            rumbleOsc.frequency.setValueAtTime(40, now);
            rumbleOsc.frequency.linearRampToValueAtTime(60, now + 2.5);
            rumbleGain.gain.setValueAtTime(0.1, now);
            rumbleGain.gain.setValueAtTime(0.1, now + 2.2);
            rumbleGain.gain.exponentialRampToValueAtTime(0.01, now + 2.6);
            rumbleOsc.connect(rumbleGain);
            rumbleGain.connect(audioCtx.destination);
            rumbleOsc.start(now);
            rumbleOsc.stop(now + 2.6);
            break;
          }
          
          case 'impact': {
            // Heavy hammer hit with fire roar
            const osc = audioCtx.createOscillator();
            const osc2 = audioCtx.createOscillator();
            const noise = createNoise(0.4);
            const gain = audioCtx.createGain();
            const noiseGain = audioCtx.createGain();
            const filter = audioCtx.createBiquadFilter();
            
            osc.type = 'sine';
            osc.frequency.setValueAtTime(80, now);
            osc.frequency.exponentialRampToValueAtTime(25, now + 0.4);
            
            osc2.type = 'triangle';
            osc2.frequency.setValueAtTime(50, now);
            osc2.frequency.exponentialRampToValueAtTime(18, now + 0.5);
            
            filter.type = 'lowpass';
            filter.frequency.setValueAtTime(600, now);
            filter.frequency.exponentialRampToValueAtTime(100, now + 0.4);
            
            gain.gain.setValueAtTime(0.6, now);
            gain.gain.exponentialRampToValueAtTime(0.01, now + 0.6);
            
            noiseGain.gain.setValueAtTime(0.2, now);
            noiseGain.gain.exponentialRampToValueAtTime(0.01, now + 0.15);
            
            osc.connect(gain);
            osc2.connect(gain);
            gain.connect(audioCtx.destination);
            noise.connect(filter);
            filter.connect(noiseGain);
            noiseGain.connect(audioCtx.destination);
            
            osc.start(now);
            osc2.start(now);
            osc.stop(now + 0.6);
            osc2.stop(now + 0.6);

            // Fire roar
            const fireNoise = createNoise(0.5);
            const fireFilter = audioCtx.createBiquadFilter();
            const fireGain = audioCtx.createGain();
            fireFilter.type = 'bandpass';
            fireFilter.frequency.setValueAtTime(300, now);
            fireFilter.frequency.exponentialRampToValueAtTime(1200, now + 0.15);
            fireFilter.frequency.exponentialRampToValueAtTime(200, now + 0.5);
            fireFilter.Q.setValueAtTime(2, now);
            fireGain.gain.setValueAtTime(0, now);
            fireGain.gain.linearRampToValueAtTime(0.15, now + 0.05);
            fireGain.gain.exponentialRampToValueAtTime(0.01, now + 0.5);
            fireNoise.connect(fireFilter);
            fireFilter.connect(fireGain);
            fireGain.connect(audioCtx.destination);
            break;
          }
          
          case 'lock': {
            // Heavy vault clunk
            const osc = audioCtx.createOscillator();
            const osc2 = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            const noise = createNoise(0.1);
            const noiseGain = audioCtx.createGain();
            
            osc.type = 'square';
            osc.frequency.setValueAtTime(180, now);
            osc.frequency.exponentialRampToValueAtTime(80, now + 0.08);
            
            osc2.type = 'sine';
            osc2.frequency.setValueAtTime(400, now);
            osc2.frequency.exponentialRampToValueAtTime(200, now + 0.15);
            
            gain.gain.setValueAtTime(0.3, now);
            gain.gain.exponentialRampToValueAtTime(0.01, now + 0.2);
            
            noiseGain.gain.setValueAtTime(0.15, now);
            noiseGain.gain.exponentialRampToValueAtTime(0.01, now + 0.05);
            
            osc.connect(gain);
            osc2.connect(gain);
            gain.connect(audioCtx.destination);
            noise.connect(noiseGain);
            noiseGain.connect(audioCtx.destination);
            
            osc.start(now);
            osc2.start(now);
            osc.stop(now + 0.2);
            osc2.stop(now + 0.2);

            // Metallic ring
            const ring = audioCtx.createOscillator();
            const ringGain = audioCtx.createGain();
            ring.type = 'sine';
            ring.frequency.setValueAtTime(1200, now);
            ringGain.gain.setValueAtTime(0.05, now);
            ringGain.gain.exponentialRampToValueAtTime(0.001, now + 0.4);
            ring.connect(ringGain);
            ringGain.connect(audioCtx.destination);
            ring.start(now);
            ring.stop(now + 0.4);
            break;
          }

          case 'tick': {
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.type = 'square';
            osc.frequency.setValueAtTime(1000, now);
            gain.gain.setValueAtTime(0.1, now);
            gain.gain.exponentialRampToValueAtTime(0.01, now + 0.05);
            osc.connect(gain);
            gain.connect(audioCtx.destination);
            osc.start(now);
            osc.stop(now + 0.05);
            break;
          }
        }
      } catch(e) {
        console.warn('Audio error:', e);
      }
    }

    function playEruption(intensity) {
      if (!audioCtx) return;
      const now = audioCtx.currentTime;
      
      // Low rumble burst
      const osc = audioCtx.createOscillator();
      const gain = audioCtx.createGain();
      osc.type = 'sine';
      osc.frequency.setValueAtTime(60 + intensity * 30, now);
      osc.frequency.exponentialRampToValueAtTime(30, now + 0.2 + intensity * 0.1);
      gain.gain.setValueAtTime(0.3 * intensity, now);
      gain.gain.exponentialRampToValueAtTime(0.01, now + 0.25 + intensity * 0.1);
      osc.connect(gain);
      gain.connect(audioCtx.destination);
      osc.start(now);
      osc.stop(now + 0.35);
      
      // Sizzle/hiss
      const noise = createNoise(0.2 + intensity * 0.15);
      const filter = audioCtx.createBiquadFilter();
      const noiseGain = audioCtx.createGain();
      filter.type = 'bandpass';
      filter.frequency.setValueAtTime(2000 + intensity * 1000, now);
      filter.Q.setValueAtTime(3, now);
      noiseGain.gain.setValueAtTime(0.15 * intensity, now);
      noiseGain.gain.exponentialRampToValueAtTime(0.01, now + 0.2 + intensity * 0.1);
      noise.connect(filter);
      filter.connect(noiseGain);
      noiseGain.connect(audioCtx.destination);
      
      // Bubble pop
      const pop = audioCtx.createOscillator();
      const popGain = audioCtx.createGain();
      pop.type = 'sine';
      pop.frequency.setValueAtTime(400 * intensity, now);
      pop.frequency.exponentialRampToValueAtTime(100, now + 0.08);
      popGain.gain.setValueAtTime(0.2 * intensity, now);
      popGain.gain.exponentialRampToValueAtTime(0.01, now + 0.1);
      pop.connect(popGain);
      popGain.connect(audioCtx.destination);
      pop.start(now);
      pop.stop(now + 0.1);
    }

    function createNoise(duration) {
      const bufferSize = audioCtx.sampleRate * duration;
      const buffer = audioCtx.createBuffer(1, bufferSize, audioCtx.sampleRate);
      const output = buffer.getChannelData(0);
      for (let i = 0; i < bufferSize; i++) {
        output[i] = Math.random() * 2 - 1;
      }
      const noise = audioCtx.createBufferSource();
      noise.buffer = buffer;
      noise.start();
      return noise;
    }

    // ========== SCREEN SHAKE ==========
    function screenShake(intensity = 'small') {
      if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) return;
      const app = document.getElementById('app');
      app.classList.remove('shake-small', 'shake-medium', 'shake-tiny');
      void app.offsetWidth; // Trigger reflow
      app.classList.add(`shake-${intensity}`);
      setTimeout(() => app.classList.remove(`shake-${intensity}`), 300);
    }

    // ========== EMBER PARTICLES ==========
    function createEmbers() {
      const container = document.getElementById('embers');
      if (!container || window.matchMedia('(prefers-reduced-motion: reduce)').matches) return;
      
      for (let i = 0; i < 15; i++) {
        const ember = document.createElement('div');
        ember.className = 'ember';
        ember.style.left = Math.random() * 100 + '%';
        ember.style.setProperty('--drift', (Math.random() - 0.5) * 100 + 'px');
        ember.style.animationDelay = Math.random() * 7 + 's';
        ember.style.animationDuration = (5 + Math.random() * 4) + 's';
        container.appendChild(ember);
      }
    }

    // ========== TITLE EMBERS ==========
    function createTitleEmbers(container) {
      if (!container || window.matchMedia('(prefers-reduced-motion: reduce)').matches) return;
      
      const emberContainer = document.createElement('div');
      emberContainer.className = 'title-embers';
      
      for (let i = 0; i < 6; i++) {
        const ember = document.createElement('div');
        ember.className = 'title-ember';
        ember.style.left = (20 + Math.random() * 60) + '%';
        ember.style.bottom = '0';
        ember.style.setProperty('--drift', (Math.random() - 0.5) * 60 + 'px');
        ember.style.animationDelay = Math.random() * 3 + 's';
        ember.style.animationDuration = (2 + Math.random() * 2) + 's';
        ember.style.width = (3 + Math.random() * 3) + 'px';
        ember.style.height = ember.style.width;
        emberContainer.appendChild(ember);
      }
      
      container.appendChild(emberContainer);
    }

    // ========== LAVA POOL ==========
    let lavaPoolVisible = false;
    let lavaBubbleInterval = null;

    function showLavaPool() {
      if (lavaPoolVisible) return;
      lavaPoolVisible = true;
      const pool = document.getElementById('lavaPool');
      pool.style.display = 'block';
      
      if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) return;
      
      // Start bubbles
      lavaBubbleInterval = setInterval(createLavaBubble, 400);
    }

    function hideLavaPool() {
      lavaPoolVisible = false;
      const pool = document.getElementById('lavaPool');
      pool.style.display = 'none';
      if (lavaBubbleInterval) {
        clearInterval(lavaBubbleInterval);
        lavaBubbleInterval = null;
      }
    }

    function createLavaBubble() {
      if (!lavaPoolVisible) return;
      const surface = document.getElementById('lavaPoolSurface');
      if (!surface) return;
      
      const bubble = document.createElement('div');
      bubble.className = 'lava-bubble';
      bubble.style.left = (10 + Math.random() * 80) + '%';
      bubble.style.animationDuration = (1.5 + Math.random() * 1) + 's';
      bubble.style.width = (5 + Math.random() * 8) + 'px';
      bubble.style.height = bubble.style.width;
      surface.appendChild(bubble);
      
      setTimeout(() => bubble.remove(), 2500);
    }

    // ========== LAVA ERUPTION ==========
    function createLavaEruption(points) {
      if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) return;
      
      const surface = document.getElementById('lavaPoolSurface');
      if (surface) {
        surface.classList.add('lava-pool-flash');
        setTimeout(() => surface.classList.remove('lava-pool-flash'), 300);
      }
      
      // Particle count and velocity based on points
      let particleCount, velocity, spread;
      if (points === 1) {
        particleCount = 10;
        velocity = 8;
        spread = 0.3;
      } else if (points === 2) {
        particleCount = 17;
        velocity = 12;
        spread = 0.5;
      } else {
        particleCount = 28;
        velocity = 18;
        spread = 0.7;
        screenShake('small');
      }
      
      const centerX = window.innerWidth / 2;
      const startY = window.innerHeight - 35;
      
      for (let i = 0; i < particleCount; i++) {
        const particle = document.createElement('div');
        particle.className = 'lava-particle';
        
        const size = 8 + Math.random() * 14;
        const hue = 20 + Math.random() * 30;
        const lightness = 50 + Math.random() * 20;
        
        particle.style.width = size + 'px';
        particle.style.height = size + 'px';
        particle.style.background = `radial-gradient(circle, hsl(${hue}, 100%, ${lightness}%), hsl(${hue - 10}, 100%, ${lightness - 20}%))`;
        particle.style.boxShadow = `0 0 ${size}px hsl(${hue}, 100%, 50%), 0 0 ${size * 2}px rgba(255,100,0,0.5)`;
        
        const offsetX = (Math.random() - 0.5) * 200 * spread;
        particle.style.left = (centerX + offsetX) + 'px';
        particle.style.top = startY + 'px';
        
        document.body.appendChild(particle);
        
        // Physics
        const vx = (Math.random() - 0.5) * velocity * spread * 2;
        const vy = -(velocity + Math.random() * velocity * 0.5);
        const gravity = 0.4;
        
        let x = centerX + offsetX;
        let y = startY;
        let currentVy = vy;
        let opacity = 1;
        
        function animateParticle() {
          x += vx;
          currentVy += gravity;
          y += currentVy;
          opacity -= 0.02;
          
          particle.style.left = x + 'px';
          particle.style.top = y + 'px';
          particle.style.opacity = Math.max(0, opacity);
          particle.style.transform = `scale(${Math.max(0.2, opacity)})`;
          
          if (opacity > 0 && y < window.innerHeight + 50) {
            requestAnimationFrame(animateParticle);
          } else {
            particle.remove();
          }
        }
        
        setTimeout(() => requestAnimationFrame(animateParticle), i * 15);
      }
    }

    // ========== SPARK PARTICLES ==========
    function createSparks(x, y, count = 5) {
      if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) return;
      
      for (let i = 0; i < count; i++) {
        const spark = document.createElement('div');
        spark.className = 'spark';
        spark.style.left = x + 'px';
        spark.style.top = y + 'px';
        spark.style.position = 'fixed';
        spark.style.zIndex = '1000';
        
        const size = 3 + Math.random() * 3;
        spark.style.width = size + 'px';
        spark.style.height = size + 'px';
        
        document.body.appendChild(spark);
        
        const angle = (Math.random() - 0.5) * Math.PI;
        const velocity = 3 + Math.random() * 4;
        const vx = Math.cos(angle) * velocity;
        const vy = Math.sin(angle) * velocity - 2;
        
        let currentX = x;
        let currentY = y;
        let currentVy = vy;
        let opacity = 1;
        
        function animateSpark() {
          currentX += vx;
          currentVy += 0.2;
          currentY += currentVy;
          opacity -= 0.05;
          
          spark.style.left = currentX + 'px';
          spark.style.top = currentY + 'px';
          spark.style.opacity = opacity;
          
          if (opacity > 0) {
            requestAnimationFrame(animateSpark);
          } else {
            spark.remove();
          }
        }
        
        setTimeout(() => requestAnimationFrame(animateSpark), i * 20);
      }
    }

    function createHoverSparks(element) {
      if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) return;
      
      const rect = element.getBoundingClientRect();
      const x = rect.left + 10;
      const y = rect.top + rect.height / 2;
      createSparks(x, y, 3);
    }

    // ========== TOAST ==========
    function showToast(message, duration = 2500) {
      const toast = document.getElementById('toast');
      toast.textContent = message;
      toast.classList.add('show');
      setTimeout(() => toast.classList.remove('show'), duration);
    }

    // ========== SHARE FEATURE ==========
    async function shareScore(score, resultLine) {
      const url = 'https://infinitlyal-dev.github.io/Butchometer/';
      const cleanLine = resultLine.replace(/"/g, "'");
      const text = `I scored ${score} on BUTCHOMETER: "${cleanLine}" — Ten questions. No mercy.`;
      const fullText = `${text} ${url}`;
      
      if (navigator.share) {
        try {
          await navigator.share({ title: 'BUTCHOMETER', text: text, url: url });
          playSound('tick');
        } catch(e) {
          if (e.name !== 'AbortError') copyToClipboard(fullText);
        }
      } else {
        copyToClipboard(fullText);
      }
    }

    function copyToClipboard(text) {
      navigator.clipboard.writeText(text).then(() => {
        showToast('Copied. Now find a victim.');
        playSound('tick');
      }).catch(() => showToast('Share: ' + text));
    }

    // ========== QUESTIONS ==========
    const questionsByCategory = {
      homeLife: [
        { id: 'HL01', setup: "It's 6:47 AM. You're standing in the kitchen in your underwear, staring at an empty coffee bag. There's instant in the back of the cupboard. It's been there since the previous tenant.", answers: [
          { text: "You chew the crystals raw, washed down with sink water—ancestors forged empires without fancy brews, and so will you.", points: 3 },
          { text: "You make the instant because caffeine is a chemical and chemicals don't care about your feelings. It tastes like regret but regret is still technically a flavor.", points: 2 },
          { text: "You drive to the nearest café in your pajama pants because you have standards and those standards include not drinking something that dissolves.", points: 1 }
        ]},
        { id: 'HL02', setup: "There's a spider on the wall. Medium-sized. It hasn't moved in three minutes. You've been watching it like it owes you an explanation.", answers: [
          { text: "You trap it carefully and release it outside while whispering an apology because all life has value, even life with eight legs.", points: 1 },
          { text: "You ignore it—that spider's now your tenant, earning its keep by catching flies, no rent required.", points: 3 },
          { text: "You smack it with whatever's nearby because you didn't invite it and cohabitation requires consent.", points: 2 }
        ]},
        { id: 'HL03', setup: "Someone touched the thermostat. The house is now 74 degrees. You can feel your electricity bill climbing. Sweat is forming. This is not a temperature—it's a betrayal.", answers: [
          { text: "You rip off the cover and stash it away—comfort's earned through grit, not knobs.", points: 3 },
          { text: "You call a household meeting because adults communicate.", points: 1 },
          { text: "You change it back without comment. If they change it again, you change it again. War of attrition.", points: 2 }
        ]},
        { id: 'HL04', setup: "Your phone battery is at 4%. You're not near a charger. You have one text to send and a growing sense this is somehow a personal failing.", answers: [
          { text: "You send the text and let the phone die with dignity. People survived millennia without constant communication.", points: 2 },
          { text: "You kill the battery on purpose—if it's vital, they'll track you down.", points: 3 },
          { text: "You ration every second. Low power mode. Screen brightness zero.", points: 1 }
        ]},
        { id: 'HL05', setup: "You're cooking. The smoke alarm goes off. Nothing is burning. The alarm just has opinions about your technique.", answers: [
          { text: "You fan it with a towel and continue cooking because you're not letting a ceiling beep dictate dinner.", points: 2 },
          { text: "You yank the battery out—real men smell smoke before gadgets whine.", points: 3 },
          { text: "You open every window and consider this a learning experience.", points: 1 }
        ]},
        { id: 'HL06', setup: "The WiFi is down. You've restarted the router twice. Nothing. You're watching blinking lights like they contain meaning.", answers: [
          { text: "You step outside—WiFi's a chain; break it and rediscover silence.", points: 3 },
          { text: "You unplug everything, wait thirty seconds, and accept that technology is just waiting.", points: 2 },
          { text: "You call the provider and wait on hold for twenty minutes.", points: 1 }
        ]},
        { id: 'HL07', setup: "It's 3 AM. There's a sound downstairs. Not a normal sound. You don't own a pet.", answers: [
          { text: "You stay in the room and call someone because this is how people survive horror movies.", points: 1 },
          { text: "You descend in the dark—whatever lurks picked the wrong domain.", points: 3 },
          { text: "You grab something heavy, turn on lights, and investigate. Probably the wind.", points: 2 }
        ]},
        { id: 'HL08', setup: "The fitted sheet came off the corner. Again. It's 2 AM. You're lying on a wrinkled fabric tumor.", answers: [
          { text: "You sleep on the bare mattress—sheets are luxuries.", points: 3 },
          { text: "You get up, remake the bed properly, because sleep quality matters.", points: 1 },
          { text: "You shove it back roughly and lie down before it escapes again.", points: 2 }
        ]}
      ],
      workResponsibility: [
        { id: 'WR01', setup: "Your alarm didn't go off. You're very late. The kind of late where getting ready becomes a negotiation between hygiene and punctuality.", answers: [
          { text: "You bolt out as is—appearance bows to presence.", points: 3 },
          { text: "You do everything anyway because showing up put-together matters more than on time.", points: 1 },
          { text: "You prioritize strategically. Deodorant: yes. Hair: manageable. Coffee: travel mug.", points: 2 }
        ]},
        { id: 'WR02', setup: "Someone at work brought donuts. There's one left. It's been there for hours. The donut is now a moral dilemma.", answers: [
          { text: "You claim it whole—hesitation lost it for them.", points: 3 },
          { text: "You cut it in half because compromise is civilization.", points: 2 },
          { text: "You leave it because being the person who took the last donut is a reputation.", points: 1 }
        ]},
        { id: 'WR03', setup: "Someone took credit for your idea in a meeting. In front of everyone. Just restated your point like they invented thinking.", answers: [
          { text: "You let it go and address it privately later.", points: 1 },
          { text: "You cut in sharp: 'That's my line, well echoed.'", points: 3 },
          { text: "You say 'glad you agree with what I mentioned earlier' loud enough to hear.", points: 2 }
        ]},
        { id: 'WR04', setup: "Someone messages: 'Hey, quick call?' There is no context. There is never context.", answers: [
          { text: "You ask what it's about before agreeing.", points: 1 },
          { text: "You don't respond until the problem solves itself.", points: 3 },
          { text: "You say yes and prepare for whatever this becomes.", points: 2 }
        ]}
      ],
      socialPressure: [
        { id: 'SP01', setup: "Someone waved at you. You waved back. They were waving at someone behind you. Your arm is still raised, dignity falling.", answers: [
          { text: "You pretend you were stretching. Commit to it. Full extension.", points: 1 },
          { text: "You wave harder at nothing—starts are finishes; quitters don't wave.", points: 3 },
          { text: "You own it with a brief laugh and shrug.", points: 2 }
        ]},
        { id: 'SP02', setup: "You've forgotten someone's name. You've met them three times. They clearly remember yours. They're walking toward you.", answers: [
          { text: "You dub them 'chief' or 'legend'—names are chains.", points: 3 },
          { text: "You greet them warmly without using their name.", points: 1 },
          { text: "You confess immediately. Awkward but honest.", points: 2 }
        ]},
        { id: 'SP03', setup: "Someone offers a handshake and squeezes. Hard. Harder than a greeting requires. They're reading your soul.", answers: [
          { text: "You lock in, unyielding—handshakes test mettle.", points: 3 },
          { text: "You match their pressure briefly and release.", points: 1 },
          { text: "You squeeze back proportionally—firm but not aggressive.", points: 2 }
        ]},
        { id: 'SP04', setup: "Someone tells you that you look tired. You're not tired. This is just your face.", answers: [
          { text: "You fire back 'You too'—statements rebound.", points: 3 },
          { text: "You say 'thanks, I'm fine' and move on.", points: 1 },
          { text: "You say 'I'm not tired, this is just my face' with a defensive smile.", points: 2 }
        ]},
        { id: 'SP05', setup: "You're playing a party game. Someone challenges you directly. Everyone is watching.", answers: [
          { text: "You crush them utterly—games demand victors.", points: 3 },
          { text: "You play to have fun, not to win.", points: 1 },
          { text: "You play well but keep it light. Competitive but charming.", points: 2 }
        ]},
        { id: 'SP06', setup: "Someone at a party confidently states something you know is completely, provably wrong.", answers: [
          { text: "You let it go because being right isn't always useful.", points: 1 },
          { text: "You dismantle it publicly, facts armed.", points: 3 },
          { text: "You offer a gentle 'actually' with helpful tone.", points: 2 }
        ]}
      ],
      foodConsumption: [
        { id: 'FC01', setup: "There's a container in the back of the fridge. You don't remember putting it there. The lid is bulging with ambition.", answers: [
          { text: "You devour it blind—dates are suggestions.", points: 3 },
          { text: "You throw it away unopened, container and all.", points: 1 },
          { text: "You crack it open and give it a sniff.", points: 2 }
        ]},
        { id: 'FC02', setup: "The jar won't open. Your grip keeps slipping. Someone is watching. Your entire identity now depends on pickles.", answers: [
          { text: "You run hot water over the lid because physics doesn't care about pride.", points: 1 },
          { text: "You shatter it into a bowl—jars yield to will.", points: 3 },
          { text: "You wrap it in a towel and give it one genuine effort.", points: 2 }
        ]},
        { id: 'FC03', setup: "Someone orders food 'extra spicy' and slides it toward you with a smile. This is a trap.", answers: [
          { text: "You finish it unflinching, demand more.", points: 3 },
          { text: "You decline because performing pain for entertainment isn't dignified.", points: 1 },
          { text: "You take a bite, handle what you can, maintain composure.", points: 2 }
        ]}
      ],
      outdoorsAnimals: [
        { id: 'OA01', setup: "It's raining. Your car is forty feet away. No umbrella. Your jacket hood is decorative.", answers: [
          { text: "You wait and watch the radar.", points: 1 },
          { text: "You stride normal—rain's mere water.", points: 3 },
          { text: "You pull the hood up and jog.", points: 2 }
        ]},
        { id: 'OA02', setup: "You're in the woods. There's a bear. Not close, but close enough to have an opinion about you.", answers: [
          { text: "You back away slowly, make yourself small.", points: 1 },
          { text: "You advance staring—one apex rules.", points: 3 },
          { text: "You make yourself big, make noise.", points: 2 }
        ]},
        { id: 'OA03', setup: "There's a cliff. Water below. Everyone else jumped. They're waving at you.", answers: [
          { text: "You climb back down because peer pressure is just pressure with friends.", points: 1 },
          { text: "You do a backflip—destiny calls bold.", points: 3 },
          { text: "You check the depth and jump feet-first.", points: 2 }
        ]}
      ],
      travelPublic: [
        { id: 'TP01', setup: "The parking spot is small. Very small. Someone clearly never saw a car before painting it.", answers: [
          { text: "You span two spots—lots deserve no respect.", points: 3 },
          { text: "You find another spot that doesn't require geometry.", points: 1 },
          { text: "You try it. Multiple angles. You succeed.", points: 2 }
        ]},
        { id: 'TP02', setup: "Someone is standing too close in line. Not touching. Just there. Breathing your air.", answers: [
          { text: "You suffer in silence.", points: 1 },
          { text: "You turn, stare silent—they retreat.", points: 3 },
          { text: "You step forward. They step forward. Slow-motion chase.", points: 2 }
        ]},
        { id: 'TP03', setup: "You're lost. GPS keeps saying 'recalculating' with disappointment.", answers: [
          { text: "You pull over and ask a local.", points: 1 },
          { text: "You kill the GPS—confusion's yours, not tech's.", points: 3 },
          { text: "You keep driving because all roads lead somewhere.", points: 2 }
        ]}
      ]
    };

    // ========== RESULT LINES ==========
    const resultLines = {
      low: [
        "You brought a backup phone charger to a barbecue.",
        "Your safe word is 'actually, let's just talk about it.'",
        "A weighted blanket is waiting for you somewhere.",
        "A firm handshake would require emotional preparation.",
        "Your comfort zone has a couch and a cancellation policy.",
        "You read the terms and conditions. All of them.",
        "Your fight-or-flight response is 'send a follow-up email.'",
        "You would describe yourself as 'indoorsy.'",
        "Your texts have drafts. Multiple drafts."
      ],
      mid: [
        "Competent but not memorable. Like beige, but load-bearing.",
        "You'd survive a camping trip. Probably. With complaints.",
        "Tough when it's convenient. Soft when it costs nothing.",
        "You own a toolbox. You've opened it twice.",
        "The human equivalent of a firm mattress.",
        "You handle problems. Eventually. With supervision.",
        "Functional. Dependable. Utterly unremarkable.",
        "Your risk tolerance is 'mild salsa.'",
        "Decisive when it doesn't matter. Paralyzed when it does."
      ],
      high: [
        "You've fixed something by hitting it. It worked.",
        "Your handshake has ended conversations.",
        "Pain is just your body making suggestions.",
        "Instructions are opinions from people who weren't there.",
        "Your backup plan is 'do the first plan harder.'",
        "Expiration dates are corporations showing fear.",
        "You've called something 'fine' while it was on fire.",
        "Weather reports are suggestions you've never taken.",
        "You've won an argument by just waiting. They got tired."
      ]
    };

    // ========== GAME STATE ==========
    let state = {
      screen: 'home',
      mode: null,
      players: [],
      playerNames: [''],
      currentPlayerIndex: 0,
      currentQuestionIndex: 0,
      sessionQuestions: [],
      measuring: false,
      showResult: false
    };

    // ========== LOCAL STORAGE ==========
    const STORAGE_KEY = 'butchometer_recent';
    const STORAGE_PLAYS = 'butchometer_plays';
    const STORAGE_RESULTS = 'butchometer_results';
    
    function getRecent() {
      try { return JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]'); }
      catch { return []; }
    }
    function getRecentResults() {
      try { return JSON.parse(localStorage.getItem(STORAGE_RESULTS) || '[]'); }
      catch { return []; }
    }
    function saveRecent(ids) {
      const recent = getRecent();
      const updated = [...new Set([...ids, ...recent])].slice(0, 30);
      localStorage.setItem(STORAGE_KEY, JSON.stringify(updated));
    }
    function saveRecentResult(line) {
      const recent = getRecentResults();
      const updated = [...new Set([line, ...recent])].slice(0, 15);
      localStorage.setItem(STORAGE_RESULTS, JSON.stringify(updated));
    }
    function incrementPlays() {
      const plays = parseInt(localStorage.getItem(STORAGE_PLAYS) || '0');
      localStorage.setItem(STORAGE_PLAYS, String(plays + 1));
      if ((plays + 1) % 6 === 0) {
        localStorage.setItem(STORAGE_KEY, '[]');
        localStorage.setItem(STORAGE_RESULTS, '[]');
      }
    }

    // ========== QUESTION SELECTION ==========
    function pickQuestions() {
      const recent = getRecent();
      const shuffle = arr => [...arr].sort(() => Math.random() - 0.5);
      const filter = arr => arr.filter(q => !recent.includes(q.id));
      
      const categories = { ...questionsByCategory };
      const selected = [];
      const categoryUsage = {};
      Object.keys(categories).forEach(cat => categoryUsage[cat] = 0);
      
      // First 2 from homeLife
      let homePool = shuffle(filter(categories.homeLife));
      if (homePool.length < 2) homePool = shuffle(categories.homeLife);
      selected.push({ ...homePool[0], category: 'homeLife' });
      selected.push({ ...homePool[1], category: 'homeLife' });
      categoryUsage.homeLife = 2;
      
      const otherCats = Object.keys(categories).filter(c => c !== 'homeLife');
      let lastCat = 'homeLife';
      
      for (let i = 2; i < 10; i++) {
        let available = otherCats.filter(cat => categoryUsage[cat] < 2);
        if (available.length > 1) available = available.filter(cat => cat !== lastCat);
        if (available.length === 0) available = otherCats;
        
        const cat = available[Math.floor(Math.random() * available.length)];
        let pool = shuffle(filter(categories[cat]));
        if (pool.length === 0) pool = shuffle(categories[cat]);
        
        let q = pool.find(q => !selected.some(s => s.id === q.id)) || pool[0];
        selected.push({ ...q, category: cat });
        categoryUsage[cat]++;
        lastCat = cat;
      }
      
      const labels = ['A', 'B', 'C'];
      const final = selected.map(q => ({
        ...q,
        answers: shuffle([...q.answers]).map((a, i) => ({ ...a, label: labels[i] }))
      }));
      
      saveRecent(final.map(q => q.id));
      return final;
    }

    function getResultLine(score) {
      const bracket = score <= 13 ? 'low' : score <= 22 ? 'mid' : 'high';
      const lines = resultLines[bracket];
      const recent = getRecentResults();
      let available = lines.filter(l => !recent.includes(l));
      if (available.length === 0) available = lines;
      const selected = available[Math.floor(Math.random() * available.length)];
      saveRecentResult(selected);
      return selected;
    }

    // ========== RENDER ==========
    function render() {
      const app = document.getElementById('app');
      app.innerHTML = screens[state.screen]();
      
      // Show/hide lava pool
      if (state.screen === 'quiz') {
        showLavaPool();
      } else {
        hideLavaPool();
      }
      
      // Add title embers on home screen
      if (state.screen === 'home') {
        setTimeout(() => {
          const title = document.querySelector('.forged-title');
          if (title) createTitleEmbers(title.parentElement);
        }, 100);
      }
    }

    const screens = {
      home: () => `
        <div class="min-h-screen flex flex-col items-center justify-center p-6 screen-enter">
          <div class="text-center max-w-lg heat-shimmer relative">
            <h1 class="forged-title mb-6">BUTCHOMETER</h1>
            <p class="text-xs text-[var(--text-dim)] mb-16 tracking-[0.25em] uppercase">Ten questions. No mercy.</p>
            <div class="flex flex-col gap-4 max-w-xs mx-auto">
              <button onclick="handleClick(event); selectMode('single');" class="btn py-5 px-8 rounded-lg">
                <span class="text-sm tracking-[0.2em] text-[var(--text-primary)] font-semibold">SINGLE</span>
              </button>
              <button onclick="handleClick(event); selectMode('multiplayer');" class="btn py-5 px-8 rounded-lg">
                <span class="text-sm tracking-[0.2em] text-[var(--text-primary)] font-semibold">MULTIPLAYER</span>
              </button>
            </div>
          </div>
        </div>`,

      setup: () => `
        <div class="min-h-screen p-6 screen-enter">
          <div class="max-w-md mx-auto pt-8">
            <button onclick="handleClick(event); goHome();" class="text-xs text-[var(--text-dim)] hover:text-[var(--orange)] mb-10 block tracking-wide transition-colors">← BACK</button>
            <h2 class="text-xl mb-6 tracking-[0.12em] text-[var(--orange)] font-bold uppercase">${state.mode === 'single' ? 'Identify Yourself' : 'Name the Accused'}</h2>
            <div class="card rounded-xl p-6 mb-6">
              ${state.playerNames.map((n, i) => `
                <div class="flex gap-3 mb-3">
                  <input type="text" value="${n}" oninput="updateName(${i}, this.value)" placeholder="Player ${i+1}" class="input flex-1 rounded-lg px-4 py-4 text-sm" maxlength="12">
                  ${state.mode === 'multiplayer' && state.playerNames.length > 2 ? `
                    <button onclick="handleClick(event); removePlayer(${i});" class="text-[var(--text-dim)] hover:text-[var(--orange)] px-3 transition-colors text-xl">×</button>
                  ` : ''}
                </div>
              `).join('')}
              ${state.mode === 'multiplayer' && state.playerNames.length < 6 ? `
                <button onclick="handleClick(event); addPlayer();" class="w-full border-2 border-dashed border-[var(--steel-lighter)] text-[var(--text-dim)] py-4 rounded-lg text-sm hover:border-[var(--orange-dim)] hover:text-[var(--orange)] transition-colors mt-2 tracking-wide font-medium">
                  + ADD PLAYER
                </button>
              ` : ''}
            </div>
            <button onclick="handleClick(event); startGame();" class="btn btn-primary w-full py-5 rounded-lg">
              <span class="text-sm tracking-[0.2em] text-[var(--text-primary)] font-semibold">BEGIN</span>
            </button>
          </div>
        </div>`,

      quiz: () => {
        const q = state.sessionQuestions[state.currentQuestionIndex];
        const p = state.players[state.currentPlayerIndex];
        const progress = (state.currentQuestionIndex / 10) * 100;
        const qNum = state.currentQuestionIndex + 1;
        return `
        <div class="min-h-screen p-4 md:p-6 pb-24 screen-enter">
          <div class="max-w-2xl mx-auto pt-4">
            <div class="flex justify-between items-center mb-4">
              <span class="text-xs text-[var(--text-dim)] tracking-wide font-medium">${p?.name || 'PLAYER'}</span>
              <span class="question-number text-[var(--orange)]">QUESTION ${qNum} OF 10</span>
            </div>
            <div class="progress-track h-2 rounded-full mb-8">
              <div class="progress-fill h-full rounded-full" style="width: ${progress}%"></div>
            </div>
            <div class="card rounded-xl p-6 mb-6 heavy-in">
              <p class="text-base md:text-lg leading-relaxed">${q?.setup}</p>
            </div>
            <div class="space-y-3" id="answerContainer">
              ${q?.answers.map((a, i) => `
                <button 
                  data-points="${a.points}" 
                  data-label="${a.label}"
                  onclick="handleAnswerClick(event, ${a.points});" 
                  onmouseenter="createHoverSparks(this)"
                  class="answer w-full rounded-xl p-4 text-left slide-in flex items-start" 
                  style="animation-delay: ${i * 0.08}s"
                >
                  <span class="answer-label">${a.label}</span>
                  <span class="text-sm md:text-base leading-relaxed text-[var(--text-primary)] flex-1">${a.text}</span>
                </button>`).join('')}
            </div>
            <p class="text-center text-xs text-[var(--text-muted)] mt-6">Press A, B, or C to answer</p>
          </div>
        </div>`;
      },

      results: () => {
        const p = state.players[state.currentPlayerIndex];
        const score = p?.score || 0;
        return `
        <div class="min-h-screen flex flex-col items-center justify-center p-6 screen-enter">
          <div class="text-center max-w-md">
            <p class="text-xs text-[var(--text-dim)] mb-8 tracking-[0.25em] uppercase font-medium">${p?.name}</p>
            <div class="relative w-52 h-52 mx-auto mb-10">
              <div class="gauge w-full h-full rounded-full ${state.measuring ? 'gauge-spin' : ''}"></div>
              ${!state.measuring ? `
                <div class="absolute inset-0 flex items-center justify-center">
                  <span class="text-7xl font-bold score-display score-reveal">${score}</span>
                </div>
              ` : ''}
            </div>
            ${state.showResult ? `
              <div class="heavy-in">
                <p class="text-lg mb-8 leading-relaxed max-w-sm mx-auto">"${p?.resultLine}"</p>
                <div class="flex flex-col gap-3 max-w-xs mx-auto">
                  ${state.mode === 'multiplayer' && state.currentPlayerIndex < state.players.length - 1 
                    ? `<button onclick="handleClick(event); nextPlayer();" class="btn btn-primary py-5 px-8 rounded-lg text-sm tracking-[0.15em] font-semibold">NEXT PLAYER</button>`
                    : state.mode === 'multiplayer' 
                    ? `<button onclick="handleClick(event); showLeaderboard();" class="btn btn-primary py-5 px-8 rounded-lg text-sm tracking-[0.15em] font-semibold">FINAL VERDICT</button>`
                    : `
                      <button onclick="handleClick(event); shareScore(${score}, '${p?.resultLine?.replace(/'/g, "\\'")}');" class="btn btn-primary py-5 px-8 rounded-lg share-btn">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"/><polyline points="16,6 12,2 8,6"/><line x1="12" y1="2" x2="12" y2="15"/></svg>
                        <span class="text-sm tracking-[0.12em] font-semibold">SHARE SCORE</span>
                      </button>
                      <button onclick="handleClick(event); goHome();" class="btn py-5 px-8 rounded-lg text-sm tracking-[0.15em] font-semibold">PLAY AGAIN</button>
                    `}
                </div>
                <p class="text-xs text-[var(--text-muted)] mt-8">Send this to a friend. See how butch they are.</p>
              </div>
            ` : `
              <p class="text-sm text-[var(--text-dim)] tracking-[0.2em] font-medium">MEASURING...</p>
            `}
          </div>
        </div>`;
      },

      leaderboard: () => {
        const sorted = [...state.players].sort((a, b) => b.score - a.score);
        return `
        <div class="min-h-screen p-6 screen-enter">
          <div class="max-w-md mx-auto pt-8">
            <h2 class="text-2xl mb-8 text-center tracking-[0.15em] text-[var(--orange)] font-bold">FINAL VERDICT</h2>
            <div class="space-y-3 mb-10">
              ${sorted.map((p, i) => `
                <div class="plaque rounded-xl p-5 flex items-center gap-4 slide-in" style="animation-delay: ${i * 0.1}s">
                  <span class="text-lg text-[var(--text-muted)] w-8 font-bold">${i + 1}.</span>
                  <div class="flex-1 overflow-hidden">
                    <p class="text-sm text-[var(--text-primary)] tracking-wide font-semibold">${p.name}</p>
                    <p class="text-xs text-[var(--text-dim)] truncate mt-1">${p.resultLine}</p>
                  </div>
                  <span class="text-3xl score-display font-bold">${p.score}</span>
                </div>
              `).join('')}
            </div>
            <button onclick="handleClick(event); goHome();" class="btn w-full py-5 rounded-lg text-sm tracking-[0.15em] font-semibold">DONE</button>
          </div>
        </div>`;
      }
    };

    // ========== EVENT HANDLERS ==========
    function handleClick(event) {
      initAudio();
      playSound('thunk');
      if (event) createSparks(event.clientX, event.clientY, 6);
    }

    function handleAnswerClick(event, points) {
      initAudio();
      
      // Sound based on points
      const intensity = points === 1 ? 0.4 : points === 2 ? 0.7 : 1.0;
      playSound('eruption', intensity);
      
      // Lava eruption
      createLavaEruption(points);
      
      // Local sparks
      createSparks(event.clientX, event.clientY, 8);
      
      // Process
      answer(points);
    }

    // ========== KEYBOARD SUPPORT ==========
    document.addEventListener('keydown', (e) => {
      if (state.screen !== 'quiz') return;
      
      const key = e.key.toUpperCase();
      if (['A', 'B', 'C'].includes(key)) {
        const container = document.getElementById('answerContainer');
        if (!container) return;
        
        const buttons = container.querySelectorAll('button');
        const index = key.charCodeAt(0) - 65; // A=0, B=1, C=2
        
        if (buttons[index]) {
          const points = parseInt(buttons[index].dataset.points);
          initAudio();
          
          // Fake click position at center
          const fakeEvent = { clientX: window.innerWidth / 2, clientY: window.innerHeight / 2 };
          
          const intensity = points === 1 ? 0.4 : points === 2 ? 0.7 : 1.0;
          playSound('eruption', intensity);
          createLavaEruption(points);
          createSparks(fakeEvent.clientX, fakeEvent.clientY, 8);
          
          answer(points);
        }
      }
    });

    // ========== GAME FUNCTIONS ==========
    function selectMode(mode) {
      state.mode = mode;
      state.playerNames = mode === 'multiplayer' ? ['', ''] : [''];
      state.screen = 'setup';
      playSound('whoosh');
      render();
    }

    function goHome() {
      state = { screen: 'home', mode: null, players: [], playerNames: [''], currentPlayerIndex: 0, currentQuestionIndex: 0, sessionQuestions: [], measuring: false, showResult: false };
      render();
    }

    function updateName(i, val) { state.playerNames[i] = val; }
    function addPlayer() { if (state.playerNames.length < 6) { state.playerNames.push(''); render(); } }
    function removePlayer(i) { if (state.playerNames.length > 2) { state.playerNames.splice(i, 1); render(); } }

    function startGame() {
      const names = state.playerNames;
      if (state.mode === 'multiplayer' && names.filter(n => n.trim()).length < 2) return;
      state.players = names.map((n, i) => ({ id: i, name: n.trim() || `Player ${i + 1}`, score: 0, answers: [], resultLine: '' }));
      state.currentPlayerIndex = 0;
      state.currentQuestionIndex = 0;
      state.sessionQuestions = pickQuestions();
      state.screen = 'quiz';
      playSound('whoosh');
      incrementPlays();
      render();
    }

    function answer(points) {
      state.players[state.currentPlayerIndex].score += points;

      if (state.currentQuestionIndex < 9) {
        state.currentQuestionIndex++;
        playSound('tick');
        render();
      } else {
        state.players[state.currentPlayerIndex].resultLine = getResultLine(state.players[state.currentPlayerIndex].score);
        state.measuring = true;
        state.showResult = false;
        state.screen = 'results';
        playSound('spinStart');
        render();
        
        setTimeout(() => {
          state.measuring = false;
          playSound('impact');
          screenShake('medium');
          render();
          setTimeout(() => {
            playSound('lock');
            screenShake('tiny');
            state.showResult = true;
            render();
          }, 400);
        }, 2600);
      }
    }

    function nextPlayer() {
      state.currentPlayerIndex++;
      state.currentQuestionIndex = 0;
      state.sessionQuestions = pickQuestions();
      state.measuring = false;
      state.showResult = false;
      state.screen = 'quiz';
      playSound('whoosh');
      render();
    }

    function showLeaderboard() {
      state.screen = 'leaderboard';
      playSound('impact');
      screenShake('small');
      render();
    }

    // ========== INIT ==========
    updateMuteIcon();
    createEmbers();
    render();
    
    document.addEventListener('click', () => initAudio(), { once: true });
    document.addEventListener('touchstart', () => initAudio(), { once: true });
  </script>
</body>
</html>
